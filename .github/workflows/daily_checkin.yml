name: Daily Auto Check-in

on:
  schedule:
    # 每天 UTC 1:30 运行 (即北京时间 9:30)
    - cron: '30 1 * * *'
  workflow_dispatch: # 允许手动点击按钮触发测试

jobs:
  checkin:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # 使用较新的 Node 版本以支持 fetch

      - name: Run Check-in Script
        env:
          # 从 GitHub Secrets 读取敏感数据
          PUSHPLUS_TOKEN: ${{ secrets.PUSHPLUS_TOKEN }}
          USER_TOKEN: ${{ secrets.USER_TOKEN }}
          USER_COOKIE: ${{ secrets.USER_COOKIE }}
          # 设置时区，方便日志查看
          TZ: Asia/Shanghai
        run: node checkin.js