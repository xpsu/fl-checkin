name: 每日自动签到 # Workflow 的名字

on:
  # 1. 定时触发
  schedule:
    # ⚠️ 重要：GitHub Actions 使用 UTC 时间
    # 北京时间是 UTC+8
    # 所以如果你想在北京时间每天早上 9:00 运行
    # UTC 时间就是 1:00 (9 - 8 = 1)
    - cron: '0 1 * * *'

  # 2. 允许手动触发 (方便测试)
  # 在 GitHub 页面 Actions 选项卡中可以点击 "Run workflow" 按钮
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 第一步：下载代码仓库
      - name: Checkout code
        uses: actions/checkout@v3

      # 第二步：安装 Node.js 环境
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      # 第三步：安装依赖 (axios)
      - name: Install dependencies
        run: npm install

      # 第四步：运行脚本
      - name: Run checkin script
        run: node index.js
        env:
          # 这里将 GitHub Secrets 中的变量注入到环境变量中
          MY_COOKIE: ${{ secrets.MY_COOKIE }}
          PUSH_PLUS_TOKEN: ${{ secrets.PUSH_PLUS_TOKEN }}